import numpy as np
import matplotlib.pyplot as plt
from matplotlib.pyplot import MultipleLocator

# 创建一个示例的numpy数组
loss = np.array([1.0047656297683716, 0.8635339140892029, 0.6117978692054749, 0.6033857464790344, 0.6229991912841797, 0.6874480247497559, 0.8054211139678955, 0.9365144968032837, 0.8791656494140625, 0.864905059337616, 0.875598132610321, 0.8757615685462952, 0.8757321238517761, 0.876480221748352, 0.87405925989151, 0.8762083053588867, 0.8741605877876282, 0.8758864998817444, 0.8742287755012512, 0.8760066032409668, 0.8741199970245361, 0.8761142492294312, 0.8741829991340637, 0.8763691782951355, 0.8740562200546265, 0.8758819103240967, 0.8742615580558777, 0.875802755355835, 0.8742275834083557, 0.8762103319168091, 0.8739460706710815, 0.8760453462600708, 0.8741535544395447, 0.8760594129562378, 0.8739919662475586, 0.8760474324226379, 0.8742268085479736, 0.87623530626297, 0.8742049932479858, 0.8760935068130493, 0.8741114139556885, 0.8760049939155579, 0.8742101788520813, 0.8762155175209045, 0.8740425109863281, 0.8761992454528809, 0.8741252422332764, 0.8761035799980164, 0.8740361332893372, 0.8761575818061829, 0.8740978240966797, 0.8760780096054077, 0.8740403056144714, 0.8761594891548157, 0.8741395473480225, 0.8762671947479248, 0.8739809989929199, 0.876105546951294, 0.8741805553436279, 0.8759212493896484, 0.8741748332977295, 0.8759396076202393, 0.8743340969085693, 0.8761107921600342, 0.8740769624710083, 0.8761815428733826, 0.874302327632904, 0.8762033581733704, 0.8740490674972534, 0.876076340675354, 0.8742539286613464, 0.876007080078125, 0.8741804361343384, 0.876068115234375, 0.8740618824958801, 0.8759205341339111, 0.874253511428833, 0.8761340379714966, 0.8741766214370728, 0.8759558200836182, 0.874224066734314, 0.8760876059532166, 0.8741084337234497, 0.8762418031692505, 0.8741477131843567, 0.8761784434318542, 0.8741535544395447, 0.8761036992073059, 0.8741427659988403, 0.8761458396911621, 0.8741680979728699, 0.8762504458427429, 0.8740614056587219, 0.8758561611175537, 0.8740918636322021, 0.8760311603546143, 0.8741065859794617, 0.8759863376617432, 0.874267578125, 0.8760759830474854, 0.8742431402206421, 0.8760178685188293, 0.8741339445114136, 0.8762071132659912, 0.8740252256393433, 0.876309335231781, 0.8740336894989014, 0.8762376308441162, 0.8739984631538391, 0.8758566379547119, 0.874027669429779, 0.876069188117981, 0.8741369247436523, 0.8761160969734192, 0.8740785121917725, 0.875944972038269, 0.8743484020233154, 0.8762995600700378, 0.8740686774253845, 0.8760910630226135, 0.8740098476409912, 0.8763983249664307, 0.8738967180252075, 0.8760067820549011, 0.8742021918296814, 0.876075267791748, 0.8740425109863281, 0.8761823177337646, 0.8741622567176819, 0.8760494589805603, 0.874143123626709, 0.8761923313140869, 0.8743322491645813, 0.8760989308357239, 0.8741896152496338, 0.8760182857513428, 0.8741825819015503, 0.8761113286018372, 0.8741825819015503, 0.8760510683059692, 0.8740016222000122, 0.8761197328567505, 0.8741798400878906, 0.8760159611701965, 0.8740896582603455, 0.8762046098709106, 0.8741422295570374, 0.8760926723480225, 0.874093770980835, 0.8764575719833374, 0.873981773853302, 0.8762449622154236, 0.8740310668945312, 0.8760595321655273, 0.8740717768669128, 0.8761128783226013, 0.8740975260734558, 0.8762797117233276, 0.8740899562835693, 0.8762081861495972, 0.874257504940033, 0.8760276436805725, 0.8742707371711731, 0.8760381937026978, 0.8741833567619324, 0.8762200474739075, 0.8741630911827087, 0.8762049078941345, 0.8742396235466003, 0.8762476444244385, 0.8743215799331665, 0.8761831521987915, 0.8742136359214783, 0.8760548233985901, 0.8741085529327393, 0.8762291669845581, 0.8739914298057556, 0.875967264175415, 0.8742062449455261, 0.8760005235671997, 0.8743895292282104, 0.8761167526245117, 0.8742523193359375, 0.876124382019043, 0.8739502429962158, 0.8760836720466614, 0.8742051720619202, 0.8760889768600464, 0.8742580413818359, 0.8757382035255432, 0.8746262192726135, 0.8757148385047913, 0.8742014765739441, 0.876210629940033, 0.8741779327392578, 0.8760491609573364, 0.8740586638450623, 0.876052975654602, 0.8741103410720825, 0.8761257529258728, 0.8742697834968567, 0.8761125802993774, 0.8741489052772522, 0.8761311769485474, 0.8742063045501709, 0.8760626316070557, 0.8739562630653381, 0.8762637376785278, 0.8742321729660034, 0.8763262629508972, 0.874038815498352, 0.8761059641838074, 0.874099612236023, 0.8761769533157349, 0.8741231560707092, 0.8761153221130371, 0.874114990234375, 0.8761001229286194, 0.8740594983100891, 0.8759814500808716, 0.8743159174919128, 0.8760932683944702, 0.8740946054458618, 0.8758198618888855, 0.8740174770355225, 0.8760966062545776, 0.8740136623382568, 0.8761329650878906, 0.8741409182548523, 0.8761744499206543, 0.873990535736084, 0.8761885166168213, 0.8740949034690857, 0.8762940168380737, 0.8743159770965576, 0.8761532306671143, 0.8739913702011108, 0.8759138584136963, 0.8741632103919983, 0.8760949373245239, 0.8740022778511047, 0.875921905040741, 0.8739572763442993, 0.8762864470481873, 0.8741133213043213, 0.8760842680931091, 0.8739697933197021, 0.8759368658065796, 0.8742356896400452, 0.8761563897132874, 0.8739463686943054, 0.8758143186569214, 0.8742008209228516, 0.8761675953865051, 0.8742319941520691, 0.8761746883392334, 0.8739978671073914, 0.8760380148887634, 0.8741288781166077, 0.8759872317314148, 0.8741747736930847, 0.8762314915657043, 0.874183714389801, 0.8762504458427429, 0.8739731311798096, 0.8762449622154236, 0.8741309642791748, 0.8760491609573364, 0.8740483522415161, 0.876360297203064, 0.8742048740386963, 0.8758994936943054, 0.874386727809906, 0.8762145638465881, 0.8739921450614929, 0.8761825561523438, 0.8740553855895996, 0.8760000467300415, 0.8742020130157471, 0.8756932020187378, 0.8740501403808594, 0.8759594559669495, 0.8740283250808716, 0.8759077191352844, 0.8741759061813354, 0.8761822581291199, 0.8741899728775024, 0.8762675523757935, 0.8738867044448853, 0.876207709312439, 0.8741004467010498, 0.8760794401168823, 0.8741981983184814, 0.8761906027793884, 0.8742340803146362, 0.8759034276008606, 0.8741027116775513, 0.8762314915657043, 0.874161422252655, 0.8760406970977783])

input_data = np.array([-4.0533, -4.1015, -4.1847, -4.2664, -4.372, -4.4924, -4.6196, -4.7702, -4.9451, -5.1249, -5.304, -5.49, -5.6676, -5.8349, -6.01, -6.1642, -6.3264, -6.4941, -6.6362, -6.7798, -6.8829, -6.9998, -7.062, -7.1744, -7.3325, -7.4483, -7.5128, -7.6264, -7.7621, -7.8179, -7.8963, -7.9852, -8.0834, -8.1204, -8.1621, -8.2345, -8.3192, -8.3769, -8.4024, -8.4565, -8.4938, -8.5552, -8.6239, -8.6906, -8.7611, -8.8435, -8.9288, -9.0073, -9.0557, -9.0969, -9.1274, -9.1384, -9.1719, -9.23, -9.2872, -9.3483, -9.3649, -9.3796, -9.3986, -9.4209, -9.4445, -9.4696, -9.4878, -9.5124, -9.5344, -9.5511, -9.5955, -9.6251, -9.6476, -9.6725, -9.7142, -9.7502, -9.7871, -9.8231, -9.8597, -9.9025, -9.939, -9.9826, -10.0285, -10.0675, -10.1125, -10.1609, -10.1959, -10.2295, -10.2672, -10.2981, -10.3286, -10.3603, -10.3853, -10.4161, -10.4402, -10.4771, -10.5055, -10.5261, -10.5509, -10.5744, -10.6061, -10.6262, -10.6631, -10.693, -10.719, -10.7489, -10.7702, -10.8015, -10.8229, -10.8542, -10.8737, -10.9002, -10.9232, -10.9441, -10.967, -10.9915, -11.0142, -11.0343, -11.053, -11.0717, -11.0913, -11.1092, -11.1266, -11.1455, -11.1649, -11.1841, -11.2024, -11.2207, -11.2394, -11.2578, -11.2739, -11.2887, -11.3038, -11.3196, -11.3338, -11.347, -11.3589, -11.3692, -11.3828, -11.3977, -11.4234, -11.4481, -11.4716, -11.4913, -11.5115, -11.5342, -11.555, -11.575, -11.5908, -11.6062, -11.624, -11.6433, -11.6641, -11.6793, -11.6948, -11.7137, -11.7321, -11.7502, -11.7681, -11.7857, -11.8027, -11.8187, -11.8336, -11.8469, -11.8629, -11.8811, -11.8989, -11.9096, -11.9193, -11.9321, -11.9476, -11.9633, -11.9802, -11.997, -12.0135, -12.0296, -12.043, -12.0588, -12.0764, -12.0934, -12.1097, -12.1269, -12.1443, -12.1621, -12.1761, -12.1881, -12.2068, -12.226, -12.2436, -12.2595, -12.2757, -12.2931, -12.311, -12.3296, -12.3478, -12.3632, -12.3786, -12.3945, -12.4127, -12.4308, -12.4465, -12.4612, -12.4756, -12.4935, -12.5134, -12.5309, -12.5486, -12.5656, -12.5788, -12.5883, -12.5962, -12.6025, -12.6121, -12.6245, -12.6416, -12.6613, -12.6799, -12.6985, -12.7149, -12.7294, -12.7447, -12.7615, -12.7729, -12.7849, -12.7929, -12.8014, -12.808, -12.8141, -12.8196, -12.8282, -12.8391, -12.8486, -12.8613, -12.8788, -12.8965, -12.9146, -12.9318, -12.9472, -12.9631, -12.9797, -12.9964, -13.0154, -13.0344, -13.0555, -13.0751, -13.0971, -13.1186, -13.1413, -13.1646, -13.1857, -13.2071, -13.2289, -13.2495, -13.2664, -13.2821, -13.3007, -13.3186, -13.3369, -13.3571, -13.377, -13.3965, -13.4154, -13.4347, -13.4554, -13.477, -13.4985, -13.521, -13.5434, -13.5645, -13.5851, -13.6042, -13.6238, -13.6423, -13.6607, -13.6777, -13.6944, -13.7108, -13.7259, -13.7418, -13.7596, -13.7783, -13.7961, -13.8146, -13.8305, -13.8465, -13.863, -13.8809, -13.8999, -13.9195, -13.9366, -13.9514, -13.9647, -13.9782, -13.9917, -14.0062, -14.019, -14.0309, -14.0419, -14.0535, -14.0675, -14.0802, -14.0921, -14.1021, -14.1122])

grad = np.array([-1.9855, -2.1694, -2.449, -1.3582, -1.6534, -2.891, -2.1136, 0.6407, 0.4286, -0.1172, -0.0038, -0.0046, -0.0098, -0.0358, -0.0569, 0.0398, -0.036, 0.0265, -0.0276, 0.0305, -0.0358, 0.0363, -0.0371, 0.0514, -0.0435, 0.0303, -0.0337, 0.0279, -0.0265, 0.0428, -0.0453, 0.0379, -0.0383, 0.0459, -0.0428, 0.0319, -0.0377, 0.0443, -0.0394, 0.0382, -0.0428, 0.0404, -0.0395, 0.0506, -0.0469, 0.0345, -0.0368, 0.0376, -0.0351, 0.0356, -0.0356, 0.0338, -0.0365, 0.0355, -0.0362, 0.045, -0.0414, 0.0346, -0.037, 0.0311, -0.0352, 0.0323, -0.0236, 0.0367, -0.0416, 0.0336, -0.0324, 0.0421, -0.0384, 0.0331, -0.0375, 0.0307, -0.0304, 0.0318, -0.0329, 0.0317, -0.0308, 0.0457, -0.0409, 0.028, -0.0319, 0.0385, -0.0405, 0.0435, -0.042, 0.0421, -0.042, 0.0371, -0.0389, 0.0358, -0.0376, 0.052, -0.0455, 0.0284, -0.0334, 0.0349, -0.0338, 0.0321, -0.0305, 0.0377, -0.0374, 0.0347, -0.036, 0.0428, -0.0429, 0.0474, -0.0432, 0.0391, -0.0441, 0.0264, -0.0215, 0.0344, -0.0399, 0.042, -0.039, 0.0313, -0.0319, 0.0447, -0.0428, 0.0329, -0.0382, 0.0454, -0.0423, 0.0417, -0.0416, 0.0374, -0.0422, 0.0444, -0.0427, 0.0377, -0.0347, 0.0387, -0.0413, 0.0371, -0.0359, 0.0304, -0.0293, 0.0304, -0.0273, 0.032, -0.0366, 0.0373, -0.0345, 0.0333, -0.0374, 0.0422, -0.0425, 0.0395, -0.0383, 0.0492, -0.0468, 0.0368, -0.0378, 0.0437, -0.0438, 0.0346, -0.0387, 0.0433, -0.0442, 0.0426, -0.0368, 0.034, -0.0344, 0.0335, -0.0322, 0.0382, -0.0388, 0.0326, -0.0359, 0.0415, -0.0388, 0.0364, -0.0341, 0.0317, -0.038, 0.0519, -0.0469, 0.0323, -0.0326, 0.0317, -0.0326, 0.0412, -0.041, 0.0401, -0.0453, 0.0408, -0.0383, 0.0342, -0.0296, 0.0206, -0.0114, 0.0198, -0.0289, 0.0392, -0.0436, 0.0362, -0.0358, 0.0378, -0.0392, 0.0384, -0.0399, 0.0386, -0.0332, 0.0386, -0.0409, 0.0358, -0.0349, 0.0409, -0.0423, 0.0435, -0.0384, 0.0383, -0.0435, 0.0417, -0.0394, 0.038, -0.0422, 0.0389, -0.0325, 0.028, -0.0328, 0.0393, -0.0354, 0.0258, -0.0234, 0.0408, -0.0433, 0.0383, -0.0377, 0.0361, -0.0382, 0.0433, -0.0437, 0.0449, -0.0426, 0.0343, -0.0381, 0.0318, -0.0276, 0.0381, -0.0404, 0.0309, -0.0294, 0.0417, -0.0424, 0.0401, -0.04, 0.0313, -0.0306, 0.0394, -0.0411, 0.0292, -0.0261, 0.04, -0.045, 0.0388, -0.0381, 0.0436, -0.0414, 0.033, -0.0332, 0.0346, -0.0383, 0.0489, -0.0448, 0.0375, -0.0403, 0.0359, -0.0358, 0.0471, -0.0424, 0.0285, -0.0308, 0.0395, -0.0409, 0.0426, -0.0413, 0.0371, -0.035, 0.0208, -0.02, 0.0249, -0.0214, 0.0256, -0.0331, 0.0377, -0.0373, 0.0458, -0.0465, 0.0415, -0.0417, 0.0347, -0.0348, 0.0441, -0.0427, 0.027, -0.0278, 0.04, -0.0395, 0.0357])

all_data = np.concatenate([loss, input_data])
y_min = np.floor(min(all_data))
y_max = np.ceil(max(all_data))
x_max = max(len(loss), len(input_data))

plt.figure(figsize=(15, 5))  # 设置整体图形大小
plt.subplot(1, 3, 1)  # 创建1行3列的子图，并激活第1个子图
plt.plot(loss)
plt.title('loss')
plt.xlabel('Index')
plt.ylabel('Loss Value')
plt.grid(True)
x_major_locator=MultipleLocator(0.05)
y_major_locator=MultipleLocator(50)
plt.yticks(np.arange(np.floor(min(loss)*20)/20, np.ceil(max(loss)*20)/20 + 0.05, 0.05))
plt.xlim(-25,300)
# 创建第二个子图
plt.subplot(1, 3, 2)  # 创建1行3列的子图，并激活第2个子图
plt.plot(input_data)
plt.title('input_data')
plt.xlabel('Index')
plt.ylabel('Input Data Value')
plt.grid(True)
x_major_locator=MultipleLocator(5)
y_major_locator=MultipleLocator(50)
#plt.yticks(np.arange(np.floor(min(input_data)), np.ceil(max(input_data))+0.5, 0.5)) 
plt.yticks(np.arange(y_min, y_max + 0.5, 0.5))  # 纵轴刻度间隔0.5
plt.ylim(y_min, y_max)
plt.xlim(-25,325)

# 创建第三个子图
"""
plt.subplot(1, 3, 3)  # 创建1行3列的子图，并激活第3个子图
plt.plot(grad)
plt.title('grad')
plt.xlabel('Index')
plt.ylabel('Value')
plt.grid(True)
x_major_locator=MultipleLocator(0.05)
y_major_locator=MultipleLocator(50)
plt.xlim(-25,300)
"""
# 调整子图之间的间距
plt.tight_layout()

# 保存图形为PNG格式文件
plt.savefig('minus4_minus2_plotv3.png')

# 显示图形
plt.show()   

